<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 20px;
            color: #333;
            background-color: #f8f9fa;
        }

        .invoice-container {
            max-width: 750px;
            margin: 0 auto;
            background: #ffffff;
            padding: 25px 30px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
        }

        h2,h3,h4,p { margin:4px 0; padding:0; }
        .primary-color { color: #1f4e79; }
        .accent { color: #dda000; font-weight:600; }
        .header { 
    text-align:center; 
    margin-bottom:12px;    /* reduced from 20px */
    padding:6px 0;         /* reduced from 10px */
    background:#f0f4f8; 
    border-radius:3px;     /* slightly smaller radius */
    border-bottom:2px solid #dda000; /* slightly thinner border */
}

.shop-details { 
    text-align:center; 
    margin-bottom:10px;    /* reduced from 15px */
    font-size:11px;        /* reduced from 12px */
    line-height:1.4;       /* slightly tighter */
}

.invoice-title { 
    font-size:20px;        /* reduced from 24px */
    font-weight:700; 
}

.section-title { 
    margin-top:1px;             /* smaller top margin */
    margin-bottom:2px;          /* smaller bottom margin */
    font-size:20px;             /* keep font small */
    font-weight:bold; 
    border-bottom:1px solid #1f4e79; /* thinner border */
    display:inline-block; 
    padding-bottom:1px;         /* smaller padding */
    color:#1f4e79; 
}

.info-block { 
    padding:6px;           /* reduced from 10px */
    border:1px solid #dee2e6; 
    border-radius:3px;     /* slightly smaller */
    margin-bottom:10px;    /* reduced from 15px */
    background-color:#fff; 
    font-size:11px;        /* reduced from 12px */
}
        /* -------- SMALL TABLE -------- */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            table-layout: fixed;
            font-size: 10px;               /* SMALLER FONT */
        }

        th {
            border:1px solid #adb5bd;
            padding:4px;                   /* SMALLER CELL */
            background:#1f4e79;
            font-size:10px;
            font-weight:bold;
            text-align:center;
            color:#fff;
            word-wrap: break-word;
        }

        td {
            border:1px solid #e9ecef;
            padding:4px;                   /* SMALLER CELL */
            text-align:center;
            font-size:10px;
            word-wrap: break-word;
        }

        .items-table tr:nth-child(even) td { background:#f8f9fa; }

        .summary-table { 
    width:100%; 
    margin-top:10px;          /* reduced top margin */
}

.summary-table td { 
    border:none; 
    padding:3px 0;            /* reduced padding (default was 6px) */
}

.summary-table td:first-child { 
    font-weight:bold; 
    text-align:left; 
    width:70%; 
    color:#1f4e79; 
    font-size:11px;           /* slightly smaller */
}

.summary-table td:last-child { 
    text-align:right; 
    font-weight:bold; 
    color:#000; 
    font-size:11px;           /* slightly smaller */
}

.summary-table tr:last-child td { 
    font-size:12px;           /* reduced from 14px */
    color:#c6a300; 
}

.balance-label { 
    color:#1f4e79 !important; 
    font-size:6px !important; /* reduced from 14px */
}

        .footer { text-align:center; margin-top:25px; font-size:10px; color:#6c757d; padding-top:10px; border-top:1px dashed #adb5bd; }
        .items-table {
    border-collapse: collapse;              /* Ensures full grid borders */
    border: 2px solid #1f4e79 !important;   /* Outer border */
    border-radius: 6px !important;          /* Rounded corners */
    overflow: hidden;                       /* Needed for rounded corners */
    width: 100%;
}

.items-table th,
.items-table td {
    border: 1px solid #1f4e79 !important;
    padding: 1px 2px;     /* Reduced padding */
    vertical-align: middle;
}
    </style>
</head>
<body>

<div class="invoice-container">

    <div class="shop-details">
        <h2 class="primary-color invoice-title">{{ shop_name }}</h2>
        <p>{{ shop_address }}</p>
        <p class="accent">Phone: {{ shop_phone }} | Email: {{ shop_email }}</p>
    </div>

    <div class="header">
        <h3 class="primary-color" style="font-size:18px;">SILVER INVOICE</h3>
        <p style="font-size:12px;">Customer Transaction Statement</p>
    </div>

    <div class="info-block">
        <p><strong class="accent">Customer:</strong> 
            {% if customer %}
                {{ customer.name }}
            {% else %}
                All Customers
            {% endif %}
        </p>
        <p>
            <strong class="primary-color">Date of Invoice:</strong> {{ today }}
            &nbsp; | &nbsp;
            <strong class="primary-color">Statement Period:</strong>
            <span class="accent">
                {% if from_date %}{{ from_date|date:"d-m-Y" }}{% else %}--{% endif %}
            </span>
            &nbsp; to &nbsp;
            <span class="accent">
                {% if to_date %}{{ to_date|date:"d-m-Y" }}{% else %}--{% endif %}
            </span>
        </p>
    </div>

    <h4 class="section-title">Invoice Items</h4>

    <table class="items-table">
    <thead>
        <tr>
            <th style="width:14%;">Date</th>
            <th style="width:14%;">Order Type</th>
            <th style="width:14%;">Product</th>
            <th style="width:14%;">Gross Weight (g)</th>
            <th style="width:14%;">Pure Weight (g)</th>
            <th style="width:10%;">MC</th>
            <th style="width:14%;">MC Status</th>
            <th style="width:14%; text-align:right;">Balance (g)</th>
        </tr>
    </thead>

    <tbody>
        {% for item in records %}
        <tr>

            <!-- 1) DATE -->
            <td>
                {% if item.type != 'Opening' and item.type != 'Closing' %}
                    {{ item.date }}
                {% else %}
                    -
                {% endif %}
            </td>

            <!-- 2) ORDER TYPE -->
            <td class="accent">{{ item.type }}</td>
            <td>
    {% if item.product %}
        {{ item.product }}
    {% else %}
        -
    {% endif %}
</td>

            <!-- 3) GROSS WEIGHT (Silver Given must be blank) -->
            <td>
                {% if item.type == 'Product Return' %}
                    {{ item.gross_return_weight|floatformat:3 }}
                {% else %}
                    -
                {% endif %}
            </td>

            <!-- 4) PURE WEIGHT -->
            <td>
                {% if item.type == 'Silver Given' %}
                    {{ item.gross_weight|floatformat:3 }}
                {% elif item.type == 'Product Return' %}
                    {{ item.pure_weight|floatformat:3 }}
                {% elif item.type == 'Product Given' %}
                    {{ item.pure_weight|floatformat:3 }}
                {% else %}
                    -
                {% endif %}
            </td>

            <!-- 5) MC AMOUNT -->
            <td>
                {% if item.mc_amount %}
                    {{ item.mc_amount|floatformat:3 }}
                {% else %}
                    -
                {% endif %}
            </td>

            <!-- 6) MC STATUS -->
            <td>
                {% if item.mc_given %}
                    Given
                {% elif item.mc_given == False %}
                    Not Given
                {% else %}
                    -
                {% endif %}
            </td>

            <!-- 7) BALANCE -->
            <td style="text-align:right;">
                {% if item.balance is not None %}
                    {% if item.balance < 0 %}
                        Bal {{ item.balance|floatformat:3|stringformat:"s"|slice:"1:" }}
                    {% else %}
                        Adv {{ item.balance|floatformat:3 }}
                    {% endif %}
                {% else %}
                    -
                {% endif %}
            </td>

        </tr>
        {% empty %}
        <tr>
            <td colspan="7" style="text-align:center; color:#999; padding:10px;">
                No Records Found
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

    <h4 class="section-title">Balance Summary</h4>

    <table class="summary-table">
        {% if opening_range_balance is not None %}
        <tr>
            <td>Opening Balance</td>
            <td>
                {% if opening_range_balance < 0 %}
                    Bal {{ opening_range_balance|floatformat:3|stringformat:"s"|slice:"1:" }} g
                {% else %}
                    Adv {{ opening_range_balance|floatformat:3 }} g
                {% endif %}
            </td>
        </tr>
        {% endif %}
        <tr>
            <td>Total Silver Given</td>
            <td>{{ total_given|floatformat:3 }} g</td>
        </tr>
        <tr>
            <td>Total Silver Returned</td>
            <td>{{ total_return|floatformat:3 }} g</td>
        </tr>
        {% if closing_range_balance is not None %}
        <tr>
            <td>Closing Balance</td>
            <td>
                {% if closing_range_balance < 0 %}
                    Bal {{ closing_range_balance|floatformat:3|stringformat:"s"|slice:"1:" }} g
                {% else %}
                    Adv {{ closing_range_balance|floatformat:3 }} g
                {% endif %}
            </td>
        </tr>
        {% endif %}
        <tr>
            <td class="balance-label">**CURRENT BALANCE**</td>
            <td style="color:#1f4e79; font-size:14px;">
                {% if current_balance < 0 %}
                    Bal {{ current_balance|floatformat:3|stringformat:"s"|slice:"1:" }} g
                {% else %}
                    Adv {{ current_balance|floatformat:3 }} g
                {% endif %}
            </td>
        </tr>
    </table>

    <div class="footer">
        <p>Thank you for your business. This is a computer-generated document, no signature is required.</p>
    </div>

</div>

</body>
</html>
